<!DOCTYPE html>
<html>
<head>
    <title>Sovereign RMM</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0f172a; color: #e2e8f0; }
        .header { background: #1e293b; padding: 1rem 2rem; border-bottom: 1px solid #334155; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 1.5rem; color: #60a5fa; }
        .header .status { color: #10b981; font-size: 0.875rem; }
        .container { max-width: 1400px; margin: 2rem auto; padding: 0 2rem; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
        .stat-card { background: #1e293b; padding: 1.5rem; border-radius: 8px; border: 1px solid #334155; }
        .stat-card h3 { color: #94a3b8; font-size: 0.875rem; text-transform: uppercase; margin-bottom: 0.5rem; }
        .stat-card .value { font-size: 2rem; font-weight: bold; color: #60a5fa; }
        .devices { background: #1e293b; padding: 1.5rem; border-radius: 8px; border: 1px solid #334155; }
        .devices h2 { margin-bottom: 1rem; color: #e2e8f0; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 0.75rem; text-align: left; border-bottom: 1px solid #334155; }
        th { background: #0f172a; font-weight: 600; color: #94a3b8; }
        .status-badge { padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; }
        .status-online { background: #065f46; color: #10b981; }
        .status-offline { background: #7f1d1d; color: #ef4444; }
        .loading { text-align: center; padding: 2rem; color: #64748b; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üñ•Ô∏è Sovereign RMM</h1>
        <div class="status">‚óè Connected</div>
    </div>
    <div class="container">
        <div class="stats">
            <div class="stat-card"><h3>Total Devices</h3><div class="value" id="total-devices">0</div></div>
            <div class="stat-card"><h3>Online</h3><div class="value" style="color: #10b981;" id="online-devices">0</div></div>
            <div class="stat-card"><h3>Offline</h3><div class="value" style="color: #ef4444;" id="offline-devices">0</div></div>
            <div class="stat-card"><h3>Alerts</h3><div class="value" style="color: #f59e0b;">0</div></div>
        </div>
        <div class="devices"><h2>Devices</h2><div id="devices-table"><div class="loading">Loading devices...</div></div></div>
    </div>
    <script>
        async function loadDevices() {
            try {
                const response = await fetch('/api/devices/');
                const devices = await response.json();
                document.getElementById('total-devices').textContent = devices.length;
                document.getElementById('online-devices').textContent = devices.filter(d => d.status === 'online').length;
                document.getElementById('offline-devices').textContent = devices.filter(d => d.status === 'offline').length;
                const tableHTML = '<table><thead><tr><th>Hostname</th><th>Type</th><th>IP</th><th>OS</th><th>Status</th><th>Last Seen</th></tr></thead><tbody>' +
                    devices.map(d => '<tr><td>'+d.hostname+'</td><td>'+(d.device_type||'-')+'</td><td>'+(d.ip_address||'-')+'</td><td>'+(d.os_version||'-')+'</td><td><span class="status-badge status-'+d.status+'">'+d.status+'</span></td><td>'+(d.last_seen ? new Date(d.last_seen).toLocaleString() : 'Never')+'</td></tr>').join('') +
                    '</tbody></table>';
                document.getElementById('devices-table').innerHTML = tableHTML;
            } catch (error) {
                document.getElementById('devices-table').innerHTML = '<div class="loading">Failed to load devices</div>';
            }
        }
        loadDevices();
        setInterval(loadDevices, 30000);
    </script>
</body>
</html>
